pipeline {
    agent none           
    stages 
    {
        stage('checkout') {
            agent { label 'node-slave'}
            steps {
                sh 'ls'
                sh 'pwd'
            }
        }
         stage('build') {
             agent { label 'node-slave'}
            steps {
                    sh 'mvn clean package'
                }
            }
         stage('publish') { 
             agent { label 'node-slave'}
            steps {
                    sh 'mkdir -p ~/.m2'
                    sh '''
                    echo "<settings>
                            <servers>
                                <server>
                                  <id>new-hello-world-war-libs-release</id>
                                  <username>admin</username>
                                  <password>cmVmdGtuOjAxOjE3NzAzNjk2MjA6ejIxY0VGRFhZT0JIZWFZRTEwd3hNd3g0NUlj</password>
                                </server>
                              </servers>
                            </settings>" > ~/.m2/settings.xml
                    '''
                sh 'cat ~/.m2/settings.xml'
                sh 'mvn clean deploy'
            }    
        }
       
    }   
}
